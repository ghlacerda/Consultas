SELECT 
		UPPER(NOME) AS colaborador_NAME
		,CGCCPF AS colaborador_identification
		,302 [Indicador que ele será avalidado(ID)]
		,SUM(QTDVGCONCLUIDAS) AS resultado
	    ,SUM(TOTALVG) AS fator_0
	    ,NUMEROVIAGEM AS fator_1
	    ,0 AS fator_2
	    ,0 AS fator_3
	    ,0 AS fator_4
	    ,0 AS fator_5
	    ,0 AS fator_6
	    ,0 AS fator_7
	    ,0 AS fator_8
	    ,0 AS fator_9
	    ,0 AS fator_10
	    ,[DATA]


FROM(

SELECT   MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,CAST(D.DATAENTREGA AS DATE) AS [DATA]
		,COUNT(DISTINCT VG.HANDLE) AS QTDVGCONCLUIDAS
		,0 AS TOTALVG

FROM GLOP_VIAGENS VG
INNER JOIN GLOP_VIAGEMDOCUMENTOS DOC ON DOC.VIAGEM = VG.Handle
INNER JOIN GN_PESSOAS MOTORISTA ON MOTORISTA.Handle = VG.MOTORISTA
INNER JOIN GLGL_DOCUMENTOS D ON D.Handle = DOC.DOCUMENTOLOGISTICA
WHERE VG.DATACANCELAMENTO IS NULL
  AND DOC.SITUACAO IN (209)

  AND VG.TIPOVIAGEM IN (169,170,173)
  AND Convert(Date, D.DATAENTREGA) >= CAST(DATEADD(DD, -1, GETDATE()) AS DATE)
  AND Convert(Date, D.DATAENTREGA) < CAST(GETDATE() AS DATE)

GROUP BY MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,CAST(D.DATAENTREGA AS DATE)

UNION ALL

SELECT DISTINCT
		MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,CAST(D.DATAENTREGA AS DATE) AS [DATA]
		,0 AS QTDVGCONCLUIDAS
		,COUNT(DISTINCT VG.HANDLE) AS TOTALVG

FROM GLOP_VIAGENS VG
INNER JOIN GLOP_VIAGEMDOCUMENTOS DOC ON DOC.VIAGEM = VG.Handle
INNER JOIN GN_PESSOAS MOTORISTA ON MOTORISTA.Handle = VG.MOTORISTA
INNER JOIN GLGL_DOCUMENTOS D ON D.Handle = DOC.DOCUMENTOLOGISTICA
WHERE VG.DATACANCELAMENTO IS NULL
  AND Convert(Date, D.DATAENTREGA) >= CAST(DATEADD(DD, -1, GETDATE()) AS DATE)
  AND Convert(Date, D.DATAENTREGA) < CAST(GETDATE() AS DATE)

GROUP BY MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,CAST(D.DATAENTREGA AS DATE)
) AS T

WHERE REPLACE(REPLACE(CGCCPF, '.',''),'-','') IN
(
'35346213600'
,'05030245626'
,'06513837650'
,'88635376749'
,'11350028606'
,'08791857678'
,'92162274515'
,'57124418615'
,'11480174610'
,'04539300695'
,'05845590892'
,'04501385693'
,'10214008665'
,'06727552622'
,'13503679740'
,'57058911649'
,'07481083860'
,'23370335972'
,'14632715735'
,'10789406810'
)

GROUP BY CGCCPF
		,NOME
		,[DATA]
		,NUMEROVIAGEM