                                                        
                       --(SELECT IsNull(SUM(VALORFRETE), 0)                                                                                                                                                                                         
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.VALORTOTALRECEBER           VALORFRETE                                                                                                                                                              
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                         
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER)    TB) +                                                                                                                                                                   
                       --(SELECT IsNull(SUM(VALORTOTALRECEBER), 0)                                                                                                                                                                            
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                            DL.VALORTOTALRECEBER                                                                                                                                                                                  
                       --                   FROM GLOP_VIAGEMDOCUMENTOS           VD                                                                                                                                                                      
                       --                  INNER JOIN GLOP_OCORRENCIAS           OC     ON OC.HANDLE        = VD.OCORRENCIA                                                                                                          
                       --                  INNER JOIN GLOP_MOTIVOOCORRENCIAS     MOC ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                          
                       --                                                                                 AND PAGARFORNECEDOR = 'S'                                                                                                                    
                       --                  INNER JOIN GLGL_DOCUMENTOS                   DL     ON DL.HANDLE    = VD.DOCUMENTOLOGISTICA                                                                                            
                       --                  WHERE VD.VIAGEM                                                                       = V.HANDLE                                                                                                               
                       --                     AND VD.TIPOSERVICO                                                                  = 197                                                                                                                    
                       --                  GROUP BY DL.HANDLE,                                                                                                                                                                                                   
                       --                                 DL.VALORTOTALRECEBER) TB)                                                                         [TOTALRECEITA],                                                                        
                       --(SELECT IsNull(SUM(VALORFRETE), 0)                                                                                                                                                                                         
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.VALORTOTALRECEBER           VALORFRETE                                                                                                                                                              
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                         
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER)    TB)                                                                              [RECEITACOLETA],                                                                 
                       --(SELECT IsNull(SUM(VALORTOTALRECEBER), 0)                                                                                                                                                                            
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                            DL.VALORTOTALRECEBER                                                                                                                                                                                  
                       --                   FROM GLOP_VIAGEMDOCUMENTOS           VD                                                                                                                                                                      
                       --                  INNER JOIN GLOP_OCORRENCIAS           OC     ON OC.HANDLE        = VD.OCORRENCIA                                                                                                          
                       --                  INNER JOIN GLOP_MOTIVOOCORRENCIAS     MOC ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                          
                       --                                                                                 AND PAGARFORNECEDOR = 'S'                                                                                                                    
                       --                  INNER JOIN GLGL_DOCUMENTOS                   DL     ON DL.HANDLE    = VD.DOCUMENTOLOGISTICA                                                                                            
                       --                  WHERE VD.VIAGEM                                                                       = V.HANDLE                                                                                                               
                       --                     AND VD.TIPOSERVICO                                                                  = 197                                                                                                                    
                       --                  GROUP BY DL.HANDLE,                                                                                                                                                                                                   
                       --                                 DL.VALORTOTALRECEBER) TB)                                                                         [RECEITAENTREGA],                                                                
                       --(SELECT SUM(D.DOCCLIPESOTOTAL)                                                                                                                                                                                             
                       --      FROM GLGL_DOCUMENTOS D                                                                                                                                                                                                      
                       --    INNER JOIN GLOP_VIAGEMDOCUMENTOS DV    ON (DV.DOCUMENTOLOGISTICA  = D.HANDLE)                                                                                                                
                       --    WHERE DV.VIAGEM                                                                                     = V.HANDLE) +                                                                                                     
                       --(SELECT IsNull(SUM(PESO), 0)                                                                                                                                                                                                      
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.DOCCLIPESOTOTAL             PESO                                                                                                                                                                    
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                  INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                         
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.DOCCLIPESOTOTAL)      TB)                                                                              [PESOREAL],                                                                            
                       --(SELECT SUM(D.DOCCLIPESOCUBADOTOTAL)                                                                                                                                                                                       
                       --   FROM GLGL_DOCUMENTOS D                                                                                                                                                                                                         
                       --    INNER JOIN GLOP_VIAGEMDOCUMENTOS DV    ON (DV.DOCUMENTOLOGISTICA  = D.HANDLE)                                                                                                                
                       --    WHERE DV.VIAGEM                                                                                     = V.HANDLE)  +                                                                                                           
                       --(SELECT IsNull(SUM(PESO), 0)                                                                                                                                                                                                      
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.DOCCLIPESOCUBADOTOTAL       PESO                                                                                                                                                                    
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                         
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.DOCCLIPESOCUBADOTOTAL)       TB)                                                                       [PESOCUBADO],                                                                    
                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                             
                       --(SELECT IsNull(SUM(IIF(DOCCLIPESOCUBADOTOTAL > DOCCLIPESOTOTAL, DOCCLIPESOCUBADOTOTAL, DOCCLIPESOTOTAL)), 0)                                                                
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.DOCCLIPESOTOTAL,                                                                                                                                                                                           
                       --                           DL.DOCCLIPESOCUBADOTOTAL                                                                                                                                                                                      
                       --                   FROM GLOP_VIAGEMDOCUMENTOS           VD                                                                                                                                                                      
                       --                  INNER JOIN GLGL_DOCUMENTOS                   DL     ON DL.HANDLE    = VD.DOCUMENTOLOGISTICA                                                                                            
                       --                  WHERE VD.VIAGEM                                                                       = V.HANDLE                                                                                                               
                       --                     AND VD.TIPOSERVICO                                                                  = 197                                                                                                                    
                       --                  GROUP BY DL.HANDLE,                                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOTOTAL,                                                                                                                                                                                    
                       --                                  DL.DOCCLIPESOCUBADOTOTAL) TB)  +                                                                                                                                                         
                       --(SELECT SUM(DL.DOCCLIPESOCONSIDERADO)                                                                                                                                                                  
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324)))                                                                                                        
                       --                                                                               [PESOCONSIDERADO],                                                               
                                                                                                                                                                                                                                                                            
                       --(SELECT IsNull(Count(Distinct HANDLE), 0)                                                                                                                                                                            
                       --      FROM (SELECT CP.HANDLE                                                                                                                                                                                                      
                       --                 FROM GLOP_COLETAPEDIDOS                  CP                                                                                                                                                                      
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                GROUP BY CP.HANDLE)   TB)                                                                                           [QUANTIDADECOLETA],                                                              
                       --(SELECT IsNull(Count(Distinct HANDLE), 0)                                                                                                                                                                            
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                            DL.VALORTOTALRECEBER                                                                                                                                                                                  
                       --                   FROM GLOP_VIAGEMDOCUMENTOS           VD                                                                                                                                                                      
                       --                  INNER JOIN GLOP_OCORRENCIAS           OC     ON OC.HANDLE        = VD.OCORRENCIA                                                                                                          
                       --                  INNER JOIN GLGL_DOCUMENTOS            DL     ON DL.HANDLE        = VD.DOCUMENTOLOGISTICA                                                                                           
                       --                  WHERE VD.VIAGEM                                                                       = V.HANDLE                                                                                                               
                       --                     AND VD.TIPOSERVICO                                                                  = 197                                                                                                                    
                       --                  GROUP BY DL.HANDLE,                                                                                                                                                                                                   
                       --                                 DL.VALORTOTALRECEBER) TB)                                                                         [QUANTIDADEENTREGA],                                                      
                       --(SELECT IsNull(SUM(IIF(DOCCLIPESOCUBADOTOTAL>DOCCLIPESOTOTAL, DOCCLIPESOCUBADOTOTAL, DOCCLIPESOTOTAL)), 0)                                                                
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.DOCCLIPESOTOTAL,                                                                                                                                                                                           
                       --                           DL.DOCCLIPESOCUBADOTOTAL                                                                                                                                                                                      
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                         
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.DOCCLIPESOTOTAL,                                                                                                                                                                                     
                       --                                 DL.DOCCLIPESOCUBADOTOTAL)       TB)                                                                       [PESOCONSIDERADOCOLETA],                                                  
                                                                                                                                                                                                                                                                             
                       --(SELECT IsNull(SUM(IIF(DOCCLIPESOCUBADOTOTAL>DOCCLIPESOTOTAL, DOCCLIPESOCUBADOTOTAL, DOCCLIPESOTOTAL)), 0)                                                                
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.DOCCLIPESOTOTAL,                                                                                                                                                                                           
                       --                           DL.DOCCLIPESOCUBADOTOTAL                                                                                                                                                                                      
                       --                   FROM GLOP_VIAGEMDOCUMENTOS           VD                                                                                                                                                                      
                       --                  INNER JOIN GLGL_DOCUMENTOS                   DL     ON DL.HANDLE    = VD.DOCUMENTOLOGISTICA                                                                                            
                       --                  WHERE VD.VIAGEM                                                                       = V.HANDLE                                                                                                               
                       --                     AND VD.TIPOSERVICO                                                                  = 197                                                                                                                    
                       --                  GROUP BY DL.HANDLE,                                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOTOTAL,                                                                                                                                                                                    
                       --                                  DL.DOCCLIPESOCUBADOTOTAL) TB)                                                              [PESOCONSIDERADOENTREGA],                                                 
                       --(SELECT IsNull(Count(Distinct PEDIDOCOLETA), 0)                                                                                                                                                                      
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                          DL.VALORTOTALRECEBER           VALORFRETE                                                                                                                                                              
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER)    TB)                                                                              [QUANTIDADECOLETAREALIZADA],                                              
                       --(SELECT IsNull(Count(Distinct HANDLE), 0)                                                                                                                                                                            
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.VALORTOTALRECEBER                                                                                                                                                                                          
                       --                  FROM GLOP_VIAGEMDOCUMENTOS            VD                                                                                                                                                                      
                       --                 INNER JOIN GLOP_OCORRENCIAS            OC            ON OC.HANDLE           = VD.OCORRENCIA                                                                                                    
                       --                 INNER JOIN GLOP_MOTIVOOCORRENCIAS      MOC           ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                    
                       --                                                                                        AND PAGARFORNECEDOR     = 'S'                                                                                                             
                       --                 INNER JOIN GLGL_DOCUMENTOS                    DL            ON DL.HANDLE        = VD.DOCUMENTOLOGISTICA                                                                                     
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.TIPOSERVICO                                                                          = 197                                                                                                             
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                 GROUP BY DL.HANDLE,                                                                                                                                                                                             
                       --                                DL.VALORTOTALRECEBER) TB)                                                                                 [QUANTIADADEENTREGAREALIZADA],                                            
                       --(SELECT IsNull(Sum(DOCCLIPESOCONSIDERADO), 0)                                                                                                                                                                        
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.DOCCLIPESOCONSIDERADO       DOCCLIPESOCONSIDERADO                                                                                                                                            
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.DOCCLIPESOCONSIDERADO)       TB)                                                                       [PESOCOLETAREALIZADO],                                                           
                       --(SELECT IsNull(Sum(DOCCLIPESOCONSIDERADO), 0)                                                                                                                                                                        
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.DOCCLIPESOCONSIDERADO                                                                                                                                                                                      
                       --                  FROM GLOP_VIAGEMDOCUMENTOS            VD                                                                                                                                                                      
                       --                 INNER JOIN GLOP_OCORRENCIAS            OC            ON OC.HANDLE           = VD.OCORRENCIA                                                                                                    
                       --                 INNER JOIN GLOP_MOTIVOOCORRENCIAS      MOC           ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                    
                       --                                                                                        AND PAGARFORNECEDOR     = 'S'                                                                                                             
                       --                 INNER JOIN GLGL_DOCUMENTOS                    DL            ON DL.HANDLE        = VD.DOCUMENTOLOGISTICA                                                                                     
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.TIPOSERVICO                                                                          = 197                                                                                                             
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                 GROUP BY DL.HANDLE,                                                                                                                                                                                             
                       --                                DL.DOCCLIPESOCONSIDERADO) TB)                                                                      [PESOENTREGAREALIZADO],                                                          
                       --VEICULO01.CAPACIDADE                                                                                                                       [CAPACIDADE],                                                                   
                       --Convert(Decimal(14,2),                                                                                                                                                                                                            
                       --((SELECT ISNULL(SUM(D.DOCCLIPESOCONSIDERADO),0)                                                                                                                                                                      
                       --    FROM GLGL_DOCUMENTOS D                                                                                                                                                                                                        
                       --      INNER JOIN GLOP_VIAGEMDOCUMENTOS DV   ON (DV.DOCUMENTOLOGISTICA  = D.HANDLE)                                                                                                                
                       --      WHERE DV.VIAGEM                                                                                    = V.HANDLE) /                                                                                                     
                       --NullIf(VEICULO01.CAPACIDADE, 0))*100)                                                                                 [OCUPACAOPESOCONSIDERADOPERCENT],                                   
                       --FRETE.VALORTOTAL                                                                                                                           [VALORCONTRATOFRETE],                                                           
                                                                                                                                                                                                                                                                             
                       --CONVERT(DECIMAL(14,2),                                                                                                                                                                                                            
                       --(FRETE.VALORTOTAL /                                                                                                                                                                                                                      
                       --NullIf(                                                                                                                                                                                                                                         
                       --(SELECT IsNull(IIF(V.TIPOVIAGEM = 173, Sum(PESO), Count(Distinct HANDLE)), 0)                                                                                                             
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.VALORTOTALRECEBER           VALORFRETE,                                                                                                                                                             
                       --                           DL.DOCCLIPESOCONSIDERADO       PESO                                                                                                                                                                    
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER,                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOCONSIDERADO)       TB)    +                                                                                                                                                                 
                       --(SELECT IsNull(IIF(V.TIPOVIAGEM = 173, Sum(PESO), Count(Distinct HANDLE)), 0)                                                                                                             
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.VALORTOTALRECEBER,                                                                                                                                                                                  
                       --                           DL.DOCCLIPESOCONSIDERADO       PESO                                                                                                                                                                    
                       --                  FROM GLOP_VIAGEMDOCUMENTOS            VD                                                                                                                                                                      
                       --                 INNER JOIN GLOP_OCORRENCIAS            OC            ON OC.HANDLE           = VD.OCORRENCIA                                                                                                    
                       --                 INNER JOIN GLOP_MOTIVOOCORRENCIAS      MOC           ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                    
                       --                                                                                        AND PAGARFORNECEDOR     = 'S'                                                                                                             
                       --                 INNER JOIN GLGL_DOCUMENTOS                    DL            ON DL.HANDLE        = VD.DOCUMENTOLOGISTICA                                                                                     
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.TIPOSERVICO                                                                          = 197                                                                                                             
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                 GROUP BY DL.HANDLE,                                                                                                                                                                                             
                       --                                DL.VALORTOTALRECEBER,                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOCONSIDERADO) TB), 0)) *                                                                                                                                                      
                       --(SELECT IsNull(IIF(V.TIPOVIAGEM = 173, Sum(PESO), Count(Distinct HANDLE)), 0)                                                                                                             
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.VALORTOTALRECEBER           VALORFRETE,                                                                                                                                                             
                       --                           DL.DOCCLIPESOCONSIDERADO       PESO                                                                                                                                                                    
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER,                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOCONSIDERADO)       TB))                                                                            [CUSTOCOLETA],                                                            
                                                                                                                                                                                                                                                                             
                       --CONVERT(DECIMAL(14,2),                                                                                                                                                                                                            
                       --(FRETE.VALORTOTAL /                                                                                                                                                                                                                      
                       --NullIf(                                                                                                                                                                                                                                         
                       --(SELECT IsNull(IIF(V.TIPOVIAGEM = 173, Sum(PESO), Count(Distinct HANDLE)), 0)                                                                                                             
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.VALORTOTALRECEBER           VALORFRETE,                                                                                                                                                             
                       --                           DL.DOCCLIPESOCONSIDERADO       PESO                                                                                                                                                                    
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER,                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOCONSIDERADO)       TB)    +                                                                                                                                                                 
                       --(SELECT IsNull(IIF(V.TIPOVIAGEM = 173, Sum(PESO), Count(Distinct HANDLE)), 0)                                                                                                             
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.VALORTOTALRECEBER,                                                                                                                                                                                  
                       --                           DL.DOCCLIPESOCONSIDERADO PESO                                                                                                                                                                   
                       --                  FROM GLOP_VIAGEMDOCUMENTOS            VD                                                                                                                                                                      
                       --                 INNER JOIN GLOP_OCORRENCIAS            OC            ON OC.HANDLE           = VD.OCORRENCIA                                                                                                    
                       --                 INNER JOIN GLOP_MOTIVOOCORRENCIAS      MOC           ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                    
                       --                                                                                        AND PAGARFORNECEDOR     = 'S'                                                                                                             
                       --                 INNER JOIN GLGL_DOCUMENTOS                    DL            ON DL.HANDLE        = VD.DOCUMENTOLOGISTICA                                                                                     
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.TIPOSERVICO                                                                          = 197                                                                                                             
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                 GROUP BY DL.HANDLE,                                                                                                                                                                                             
                       --                                DL.VALORTOTALRECEBER,                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOCONSIDERADO) TB), 0)) *                                                                                                                                                      
                       --(SELECT IsNull(IIF(V.TIPOVIAGEM = 173, Sum(PESO), Count(Distinct HANDLE)), 0)                                                                                                             
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DL.VALORTOTALRECEBER,                                                                                                                                                                                  
                       --                           DL.DOCCLIPESOCONSIDERADO PESO                                                                                                                                                                   
                       --                  FROM GLOP_VIAGEMDOCUMENTOS            VD                                                                                                                                                                      
                       --                 INNER JOIN GLOP_OCORRENCIAS            OC            ON OC.HANDLE           = VD.OCORRENCIA                                                                                                    
                       --                 INNER JOIN GLOP_MOTIVOOCORRENCIAS      MOC           ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                    
                       --                                                                                        AND PAGARFORNECEDOR     = 'S'                                                                                                             
                       --                 INNER JOIN GLGL_DOCUMENTOS                    DL            ON DL.HANDLE        = VD.DOCUMENTOLOGISTICA                                                                                     
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.TIPOSERVICO                                                                          = 197                                                                                                             
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                 GROUP BY DL.HANDLE,                                                                                                                                                                                             
                       --                                DL.VALORTOTALRECEBER,                                                                                                                                                                                   
                       --                                 DL.DOCCLIPESOCONSIDERADO) TB))                                                                     [CUSTOENTREGA],                                                                  
                                                                                                                                                                                                                                                                             
                       --CONVERT(DECIMAL(14,2),                                                                                                                                                                                                            
                       --(FRETE.VALORTOTAL / NULLIF(                                                                                                                                                                                                       
                       --(SELECT IsNull(SUM(VALORFRETE), 0)                                                                                                                                                                                         
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.VALORTOTALRECEBER           VALORFRETE                                                                                                                                                              
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                         
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.VALORTOTALRECEBER)    TB) +                                                                                                                                                                   
                       --(SELECT IsNull(SUM(VALORTOTALRECEBER), 0)                                                                                                                                                                            
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                            DL.VALORTOTALRECEBER                                                                                                                                                                                  
                       --                   FROM GLOP_VIAGEMDOCUMENTOS           VD                                                                                                                                                                      
                       --                  INNER JOIN GLOP_OCORRENCIAS           OC     ON OC.HANDLE        = VD.OCORRENCIA                                                                                                          
                       --                  INNER JOIN GLOP_MOTIVOOCORRENCIAS     MOC ON MOC.HANDLE          = OC.OCORRENCIA                                                                                                          
                       --                                                                                 AND PAGARFORNECEDOR = 'S'                                                                                                                    
                       --                  INNER JOIN GLGL_DOCUMENTOS                   DL     ON DL.HANDLE    = VD.DOCUMENTOLOGISTICA                                                                                            
                       --                  WHERE VD.VIAGEM                                                                       = V.HANDLE                                                                                                               
                       --                     AND VD.TIPOSERVICO                                                                  = 197                                                                                                                    
                       --                  GROUP BY DL.HANDLE,                                                                                                                                                                                                   
                       --                                 DL.VALORTOTALRECEBER) TB), 0))*100)                                                        [CUSTOTOTALRECEITAPERCENT],                                                      
                       --(SELECT ISNULL(SUM(D.DOCCLIVOLUME), 0)                                                                                                                                                                                     
                       --      FROM GLGL_DOCUMENTOS D                                                                                                                                                                                                      
                       --    INNER JOIN GLOP_VIAGEMDOCUMENTOS DV    ON (DV.DOCUMENTOLOGISTICA  = D.HANDLE)                                                                                                                
                       --    WHERE DV.VIAGEM                                                                                     = V.HANDLE) +                                                                                                     
                       --(SELECT IsNull(Sum(DOCCLIVOLUME), 0)                                                                                                                                                                                       
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.DOCCLIVOLUME                DOCCLIVOLUME                                                                                                                                                     
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.DOCCLIVOLUME)  TB)                                                                                    [VOLUME],                                                                              
                       --IIF(VB.HANDLE Is Null, 'No', 'Sim')                                                                                         [BLOQUEADA],                                                                     
                       --CONVERT(DECIMAL(14,2),                                                                                                                                                                                                            
                       --(SELECT SUM(D.DOCCLIVALORTOTAL)                                                                                                                                                                                                   
                       --   FROM GLGL_DOCUMENTOS D                                                                                                                                                                                                         
                       --    INNER JOIN GLOP_VIAGEMDOCUMENTOS DV    ON (DV.DOCUMENTOLOGISTICA  = D.HANDLE)                                                                                                                
                       --    WHERE DV.VIAGEM                                                                                     = V.HANDLE)) +                                                                                                           
                       --(SELECT IsNull(Sum(DOCCLIVALORTOTAL), 0)                                                                                                                                                                                   
                       --      FROM (SELECT DL.HANDLE,                                                                                                                                                                                                     
                       --                           DC.PEDIDOCOLETA                PEDIDOCOLETA,                                                                                                                                                    
                       --                           DL.DOCCLIVALORTOTAL            DOCCLIVALORTOTAL                                                                                                                                                 
                       --                 FROM GLGL_DOCUMENTOASSOCIADOS            DA                                                                                                                                                                      
                       --                INNER JOIN GLGL_DOCUMENTOCLIENTES  DC ON DC.HANDLE                         = DA.DOCUMENTOCLIENTE                                                                                       
                       --                INNER JOIN GLGL_DOCUMENTOS                DL ON DA.DOCUMENTOLOGISTICA = DL.HANDLE                                                                                                      
                       --                 INNER JOIN GLOP_COLETAPEDIDOS          CP ON CP.HANDLE                         = DC.PEDIDOCOLETA                                                                                           
                       --                 INNER JOIN GLOP_VIAGEMDOCUMENTOS VD ON VD.DOCUMENTOCOLETA       = CP.HANDLE                                                                                                       
                       --                 WHERE VD.VIAGEM                                                                               = V.HANDLE                                                                                                        
                       --                    AND VD.SITUACAO                                                                             = 209                                                                                                             
                       --                    And ((DL.TIPODOCUMENTO                                                               In (1, 2)                                                                                                         
                       --                    And   DL.TIPODOCUMENTOFRETE                                                          = 153)                                                                                                            
                       --                     Or  (DL.TIPODOCUMENTO                                                               In (6)                                                                                                            
                       --                    And   DL.TIPORPS                                                                            <> 324))                                                                                                          
                       --                GROUP BY DL.HANDLE,                                                                                                                                                                                               
                       --                          DC.PEDIDOCOLETA,                                                                                                                                                                                        
                       --                          DL.DOCCLIVALORTOTAL)     TB)                                                                             [VALORMERCADORIA],                                                               
                       --VB.VALORBLOQUEIO,                                                                                                                                                                                                                 
                       --VCM.DESCRICAO                                                                                                                              [MOTIVO],                                                                              
                       --VB.OBSERVACAOAUTORIZACAO                                                                                                                   [OBSERVACAO],                                                                   
                       --USUARIO.NOME                                                                                                                                     [USUARIO],                                                                              
                       --SBV.NOME                                                                                                                                         [SUBTIPOVIAGEM],                                                                 
                       --VEICTIPO.NOME  