SELECT 
		--UPPER(NOME) AS colaborador_NAME
		REPLACE(REPLACE(CGCCPF,'.',''),'-','') AS colaborador_identification
		,302 indicador_identification
		,SUM(QTDVGCONCLUIDAS) AS resultado
	    ,SUM(TOTALVG) AS fator_0
	    ,SUM(QTDNAODEUTEMPO) AS fator_1
	    ,SUBTIPOVIAGEM AS fator_2
	    ,SUM(PESO) AS fator_3
	    ,'' AS fator_4
	    ,'' AS fator_5
	    ,'' AS fator_6
	    ,'' AS fator_7
	    ,'' AS fator_8
	    ,'' AS fator_9
	    ,'' AS fator_10
	    ,[DATA]


FROM(

SELECT   MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,SBV.NOME AS SUBTIPOVIAGEM
		,0 AS PESO
		,CAST(D.DATAENTREGA AS DATE) AS [DATA]
		,0 AS QTDVGCONCLUIDAS
		,CASE
			WHEN DATEPART(HH, O.INCLUIDOEM) >= 8 AND DATEPART(HH, O.INCLUIDOEM) < 20 THEN COUNT(DISTINCT D.NUMERO)
		ELSE 0
		END QTDNAODEUTEMPO
		,0 AS TOTALVG

FROM GLOP_VIAGENS VG
INNER JOIN GLOP_VIAGEMDOCUMENTOS DOC ON DOC.VIAGEM = VG.Handle
INNER JOIN GN_PESSOAS MOTORISTA ON MOTORISTA.Handle = VG.MOTORISTA
INNER JOIN GLGL_DOCUMENTOS D ON D.Handle = DOC.DOCUMENTOLOGISTICA
INNER JOIN GLOP_OCORRENCIAS O ON DOC.OCORRENCIA = O.HANDLE
INNER JOIN GLOP_MOTIVOOCORRENCIAS MOT ON MOT.HANDLE = O.OCORRENCIA
LEFT JOIN GLGL_SUBTIPOVIAGENS SBV ON SBV.HANDLE = VG.SUBTIPOVIAGEM

WHERE VG.DATACANCELAMENTO IS NULL
  AND (MOT.HANDLE = 20 OR MOT.OCORRENCIAPADRAO = 20)
  AND VG.TIPOVIAGEM IN (169,170,173)
  AND Convert(Date, D.DATAENTREGA) >= CAST(DATEADD(DD, -1, GETDATE()) AS DATE)
  AND Convert(Date, D.DATAENTREGA) < CAST(GETDATE() AS DATE)

GROUP BY
		MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,SBV.NOME
		,CAST(D.DATAENTREGA AS DATE)
		,DATEPART(HH, O.INCLUIDOEM)

UNION ALL

SELECT   MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,SBV.NOME AS SUBTIPOVIAGEM
		,0 AS PESO
		,CAST(D.DATAENTREGA AS DATE) AS [DATA]
		,COUNT(DISTINCT D.NUMERO) AS QTDVGCONCLUIDAS
		,0 AS QTDNAODEUTEMPO
		,0 AS TOTALVG

FROM GLOP_VIAGENS VG
INNER JOIN GLOP_VIAGEMDOCUMENTOS DOC ON DOC.VIAGEM = VG.Handle
INNER JOIN GN_PESSOAS MOTORISTA ON MOTORISTA.Handle = VG.MOTORISTA
INNER JOIN GLGL_DOCUMENTOS D ON D.Handle = DOC.DOCUMENTOLOGISTICA
LEFT JOIN GLGL_SUBTIPOVIAGENS SBV ON SBV.HANDLE = VG.SUBTIPOVIAGEM
WHERE VG.DATACANCELAMENTO IS NULL
  AND DOC.SITUACAO IN (209)

  AND VG.TIPOVIAGEM IN (169,170,173)
  AND Convert(Date, D.DATAENTREGA) >= CAST(DATEADD(DD, -1, GETDATE()) AS DATE)
  AND Convert(Date, D.DATAENTREGA) < CAST(GETDATE() AS DATE)

GROUP BY MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,SBV.NOME
		,CAST(D.DATAENTREGA AS DATE)

UNION ALL

SELECT DISTINCT
		MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,SBV.NOME AS SUBTIPOVIAGEM
		,SUM(D.DOCCLIPESOCONSIDERADO) AS PESO
		,CAST(D.DATAENTREGA AS DATE) AS [DATA]
		,0 AS QTDVGCONCLUIDAS
		,0 AS QTDNAODEUTEMPO
		,COUNT(DISTINCT D.NUMERO) AS TOTALVG

FROM GLOP_VIAGENS VG
INNER JOIN GLOP_VIAGEMDOCUMENTOS DOC ON DOC.VIAGEM = VG.Handle
INNER JOIN GN_PESSOAS MOTORISTA ON MOTORISTA.Handle = VG.MOTORISTA
INNER JOIN GLGL_DOCUMENTOS D ON D.Handle = DOC.DOCUMENTOLOGISTICA
LEFT JOIN GLGL_SUBTIPOVIAGENS SBV ON SBV.HANDLE = VG.SUBTIPOVIAGEM
WHERE VG.DATACANCELAMENTO IS NULL
  AND Convert(Date, D.DATAENTREGA) >= CAST(DATEADD(DD, -1, GETDATE()) AS DATE)
  AND Convert(Date, D.DATAENTREGA) < CAST(GETDATE() AS DATE)
  AND SUBTIPOVIAGEM <> 3

GROUP BY MOTORISTA.CGCCPF
		,MOTORISTA.NOME
		,VG.NUMEROVIAGEM
		,SBV.NOME
		,CAST(D.DATAENTREGA AS DATE)
) AS T

WHERE REPLACE(REPLACE(CGCCPF, '.',''),'-','') IN
(
--'35346213600'
--,'05030245626'
--,'06513837650'
--,'88635376749'
--,'11350028606'
--,'08791857678'
--,'92162274515'
--,'57124418615'
--,'11480174610'
--,'04539300695'
--,'05845590892'
--,'04501385693'
--,'10214008665'
--,'06727552622'
--,'13503679740'
--,'57058911649'
--,'07481083860'
--,'23370335972'
--,'14632715735'
--,'10789406810'
'90014456753'
,'88451143768'
,'11587468735'
,'03090306760'
,'14425495721'
,'09893510767'
,'12654881776'
,'03184311732'
,'14154903764'
,'01726070786'
,'74298500730'
,'47851864704'
,'36954659720'
,'07643710708'
,'81208693700'
,'11322573794'
,'84809922715'
,'11889534781'
,'01713943727'
,'07450977745'
,'79844910706'
,'99517264704'
,'15136363754'
,'13078284778'
,'09809644744'
,'90116054700'
,'07010662703'
,'26157035870'
,'08711447788'
,'00170529711'
,'11840882760'
,'11004081774'
,'92561365700'
,'49351079791'
,'00981374760'
,'52561089720'
,'07157727757'
,'46604596672'
,'99001780768'
,'20945507615'
,'57851972787'
,'03090947714'
,'00153461705'
,'76139409772'
,'14669239708'
,'86565354804'
,'12168082790'
,'03590185724'
,'00805427783'
,'15469199703'
,'05426279730'
,'12753066752'
,'02262315779'
,'06906199870'
,'10867446757'
,'92542484791'
,'15493114763'
,'00152918710'
,'00812965760'
,'11928167730'
,'08250114779'
,'04571375760'
,'00523113765'
,'07747201745'
,'61938718704'
,'08377122707'
,'02008021785'
,'04578726754'
,'17362394730'
,'62332040706'
,'12606267761'
,'09003180741'
,'96995246772'
,'83782460782'
)


GROUP BY REPLACE(REPLACE(CGCCPF,'.',''),'-','')
		,NOME
		,[DATA]
		,SUBTIPOVIAGEM
		--,NUMEROVIAGEM